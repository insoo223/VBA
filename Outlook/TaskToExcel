'=== TaskToExcel (최종갱신: 2017.8.9)
'아웃룩 작업 목록을 엑셀에 옮기기
'아웃룩 새롭게 띄우기 (새 인스턴스)
'   작업 폴더 가리키기
'   작업 항목 가리키기
'   작업 책임자, 제목, 종료예정일 정보를 엑셀에 옮기기
'==============================================================
Sub TaskToExcel()
    Dim ol As Outlook.Application
    Dim olns As Outlook.NameSpace
    Dim MyTasksFolder As Outlook.Folder
    'Dim MyFolder As Outlook.Folder
    Dim MyItems As Outlook.Items
    
    Dim apExcel As Excel.Application
    
    Dim TaskRange As String
    Dim i As Integer
    
    Set ol = New Outlook.Application
    Set olns = ol.GetNamespace("MAPI")
    'Set MyFolder = olns.GetDefaultFolder(olFolderContacts)
    Set MyTasksFolder = olns.GetDefaultFolder(olFolderTasks)
    'Set MyFolder = MyTasksFolder.Folders("PLM Alignment(Thu)")
    
    'Set MyItems = MyFolder.Items
    Set MyItems = MyTasksFolder.Items
    'MsgBox MyItems.Count
    
    'Open Excel
    Set apExcel = CreateObject("Excel.application") 'Creates an object
    apExcel.Visible = True ' So you can see Excel
    apExcel.Workbooks.Add 'Adds a new book.
    
    For i = 1 To MyItems.Count
        'MsgBox MyItems(i).Owner & "; " & MyItems(i).Subject & "; " & MyItems(i).DueDate
        apExcel.Cells(i, 1).Value = MyItems(i).Owner
        apExcel.Cells(i, 2).Value = MyItems(i).Subject
        apExcel.Cells(i, 3).Value = MyItems(i).DueDate
    Next i
    
    apExcel.Columns("A:AY").EntireColumn.AutoFit 'To adjust the column's width
    apExcel.Columns("B:B").ColumnWidth = 50
    
    TaskRange = "A1:" & "C" & MyItems.Count
    
    apExcel.Range(TaskRange).Select
    apExcel.Sheets(1).Name = "ActionItems" '& Date
    'MsgBox Date
    
    
    'MsgBox ("Hi")
    apExcel.Visible = True ' So you can see Excel
    'ApExcel.ActiveWorkbook.Close (False)
    Set apExcel = Nothing
    
End Sub 'TaskToExcel
